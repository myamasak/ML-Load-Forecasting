
runfile('C:/Users/marko/code/ML-Load-Forecasting/LSTM_impl.py', wdir='C:/Users/marko/code/ML-Load-Forecasting')
Reloaded modules: BlockingTimeSeriesSplit
The program has been started...
Any null value in dataset?
Date            False
Hour            False
DA_DEMD         False
DEMAND           True
DA_LMP          False
DA_EC           False
DA_CC           False
DA_MLC          False
RT_LMP          False
RT_EC           False
RT_CC           False
RT_MLC          False
DryBulb         False
DewPnt          False
SYSLoad         False
RegCP           False
RegSP            True
Min_5min_RSP     True
Max_5min_RSP     True
Min_5min_RCP     True
Max_5min_RCP     True
dtype: bool
How many are they?
Date                0
Hour                0
DA_DEMD             0
DEMAND              2
DA_LMP              0
DA_EC               0
DA_CC               0
DA_MLC              0
RT_LMP              0
RT_EC               0
RT_CC               0
RT_MLC              0
DryBulb             0
DewPnt              0
SYSLoad             0
RegCP               0
RegSP           17520
Min_5min_RSP    34320
Max_5min_RSP    34320
Min_5min_RCP    34320
Max_5min_RCP    34320
dtype: int64
How many zero values?
Date                0
Hour             1826
DA_DEMD             2
DEMAND              0
DA_LMP             10
DA_EC               9
DA_CC           31027
DA_MLC           1510
RT_LMP            155
RT_EC             153
RT_CC           34855
RT_MLC           1651
DryBulb            24
DewPnt            187
SYSLoad             0
RegCP            6637
RegSP            1061
Min_5min_RSP      643
Max_5min_RSP      111
Min_5min_RCP      115
Max_5min_RCP        5
dtype: int64
How many zero values in y (DEMAND)?
0
C:/Users/marko/code/ML-Load-Forecasting/LSTM_impl.py:135: FutureWarning: Method .as_matrix will be removed in a future version. Use .values instead.
  y_matrix = y.as_matrix()
C:\Users\marko\Anaconda3\envs\venvAUTO\lib\site-packages\sklearn\utils\deprecation.py:66: DeprecationWarning: Class Imputer is deprecated; Imputer was deprecated in version 0.20 and will be removed in 0.22. Import impute.SimpleImputer from sklearn instead.
  warnings.warn(msg, category=DeprecationWarning)
Epoch 1/200
41664/41664 [==============================] - 19s 467us/step - loss: 18884696.6965
Epoch 2/200
41664/41664 [==============================] - 18s 425us/step - loss: 5685705.2224
Epoch 3/200
41664/41664 [==============================] - 18s 423us/step - loss: 5576324.4327
Epoch 4/200
41664/41664 [==============================] - 18s 422us/step - loss: 5466717.9035
Epoch 5/200
41664/41664 [==============================] - 18s 422us/step - loss: 5390950.4170
Epoch 6/200
41664/41664 [==============================] - 18s 423us/step - loss: 5364842.0487
Epoch 7/200
41664/41664 [==============================] - 18s 422us/step - loss: 5368209.3923
Epoch 8/200
41664/41664 [==============================] - 18s 423us/step - loss: 5376377.5302
Epoch 9/200
41664/41664 [==============================] - 18s 424us/step - loss: 5381272.5970
Epoch 10/200
41664/41664 [==============================] - 18s 424us/step - loss: 5383523.7225
Epoch 11/200
41664/41664 [==============================] - 18s 421us/step - loss: 5384184.0774
Epoch 12/200
41664/41664 [==============================] - 18s 422us/step - loss: 5384136.2545
Epoch 13/200
41664/41664 [==============================] - 18s 424us/step - loss: 5383817.4943
Epoch 14/200
41664/41664 [==============================] - 18s 421us/step - loss: 5383347.5406
Epoch 15/200
41664/41664 [==============================] - 18s 424us/step - loss: 5380426.7731
Epoch 16/200
41664/41664 [==============================] - 18s 425us/step - loss: 5365122.9119
Epoch 17/200
41664/41664 [==============================] - 18s 427us/step - loss: 5342431.9501
Epoch 18/200
41664/41664 [==============================] - 18s 423us/step - loss: 5326446.5355
Epoch 19/200
41664/41664 [==============================] - 18s 422us/step - loss: 5313309.1895
Epoch 20/200
41664/41664 [==============================] - 18s 422us/step - loss: 5299007.8513
Epoch 21/200
41664/41664 [==============================] - 18s 422us/step - loss: 5278684.4191
Epoch 22/200
41664/41664 [==============================] - 18s 425us/step - loss: 5246294.5875
Epoch 23/200
41664/41664 [==============================] - 18s 423us/step - loss: 5201692.0727
Epoch 24/200
41664/41664 [==============================] - 18s 421us/step - loss: 5138823.8961
Epoch 25/200
41664/41664 [==============================] - 18s 423us/step - loss: 5041532.0257
Epoch 26/200
41664/41664 [==============================] - 18s 422us/step - loss: 4920244.3283
Epoch 27/200
41664/41664 [==============================] - 18s 423us/step - loss: 4788088.0486
Epoch 28/200
41664/41664 [==============================] - 18s 422us/step - loss: 4655552.9798
Epoch 29/200
41664/41664 [==============================] - 18s 423us/step - loss: 4547770.4072
Epoch 30/200
41664/41664 [==============================] - 18s 422us/step - loss: 4483886.3460
Epoch 31/200
41664/41664 [==============================] - 18s 422us/step - loss: 4462593.2153
Epoch 32/200
41664/41664 [==============================] - 18s 424us/step - loss: 4441014.3803
Epoch 33/200
41664/41664 [==============================] - 18s 422us/step - loss: 4416320.8308
Epoch 34/200
41664/41664 [==============================] - 18s 423us/step - loss: 4385563.6721
Epoch 35/200
41664/41664 [==============================] - 18s 421us/step - loss: 4364498.990541664 [=====>........................] - ETA: 13s - loss: 4611830.6790
Epoch 36/200
41664/41664 [==============================] - 18s 422us/step - loss: 4344802.2260
Epoch 37/200
41664/41664 [==============================] - 18s 423us/step - loss: 4328529.8185
Epoch 38/200
41664/41664 [==============================] - 18s 422us/step - loss: 4323539.2058
Epoch 39/200
41664/41664 [==============================] - 18s 422us/step - loss: 4317393.1501
Epoch 40/200
41664/41664 [==============================] - 18s 423us/step - loss: 4311933.2347
Epoch 41/200
41664/41664 [==============================] - 18s 424us/step - loss: 4301653.6680
Epoch 42/200
41664/41664 [==============================] - 18s 421us/step - loss: 4292873.7164
Epoch 43/200
41664/41664 [==============================] - 18s 423us/step - loss: 4287436.0300
Epoch 44/200
41664/41664 [==============================] - 18s 423us/step - loss: 4276279.5975
Epoch 45/200
41664/41664 [==============================] - 18s 424us/step - loss: 4268439.4376
Epoch 46/200
41664/41664 [==============================] - 18s 423us/step - loss: 4263101.6287
Epoch 47/200
41664/41664 [==============================] - 18s 424us/step - loss: 4256147.2244
Epoch 48/200
41664/41664 [==============================] - 18s 421us/step - loss: 4248582.6767
Epoch 49/200
41664/41664 [==============================] - 18s 424us/step - loss: 4237053.4118
Epoch 50/200
41664/41664 [==============================] - 18s 423us/step - loss: 4222176.4919
Epoch 51/200
41664/41664 [==============================] - 18s 422us/step - loss: 4204414.6333
Epoch 52/200
41664/41664 [==============================] - 18s 422us/step - loss: 4190888.1962
Epoch 53/200
41664/41664 [==============================] - 17s 418us/step - loss: 4172090.3171
Epoch 54/200
41664/41664 [==============================] - 17s 420us/step - loss: 4169118.2120
Epoch 55/200
41664/41664 [==============================] - 17s 419us/step - loss: 4169211.3463
Epoch 56/200
41664/41664 [==============================] - 17s 418us/step - loss: 4170726.3301
Epoch 57/200
41664/41664 [==============================] - 17s 418us/step - loss: 4165670.8176
Epoch 58/200
41664/41664 [==============================] - 17s 419us/step - loss: 4152115.5358
Epoch 59/200
41664/41664 [==============================] - 17s 417us/step - loss: 4140113.8245
Epoch 60/200
41664/41664 [==============================] - 17s 418us/step - loss: 4123838.0516
Epoch 61/200
41664/41664 [==============================] - 17s 420us/step - loss: 4108311.4281
Epoch 62/200
41664/41664 [==============================] - 17s 417us/step - loss: 4089133.3679
Epoch 63/200
41664/41664 [==============================] - 17s 419us/step - loss: 4086458.8025
Epoch 64/200
41664/41664 [==============================] - 17s 418us/step - loss: 4088464.1604
Epoch 65/200
41664/41664 [==============================] - 17s 419us/step - loss: 4084704.3444
Epoch 66/200
41664/41664 [==============================] - 17s 420us/step - loss: 4087181.6048
Epoch 67/200
41664/41664 [==============================] - 17s 418us/step - loss: 4072651.9035
Epoch 68/200
41664/41664 [==============================] - 18s 420us/step - loss: 4081189.1866
Epoch 69/200
41664/41664 [==============================] - 17s 417us/step - loss: 4074499.8444
Epoch 70/200
41664/41664 [==============================] - 17s 419us/step - loss: 4062179.4663
Epoch 71/200
41664/41664 [==============================] - 17s 417us/step - loss: 4045195.3205
Epoch 72/200
41664/41664 [==============================] - 17s 418us/step - loss: 4035795.4199
Epoch 73/200
41664/41664 [==============================] - 18s 420us/step - loss: 4023465.2284
Epoch 74/200
41664/41664 [==============================] - 17s 419us/step - loss: 3994868.1900
Epoch 75/200
41664/41664 [==============================] - 17s 417us/step - loss: 3975370.8901
Epoch 76/200
41664/41664 [==============================] - 17s 418us/step - loss: 3954827.9739
Epoch 77/200
41664/41664 [==============================] - 17s 418us/step - loss: 3935179.9491
Epoch 78/200
41664/41664 [==============================] - 17s 418us/step - loss: 3917543.2675
Epoch 79/200
41664/41664 [==============================] - 17s 418us/step - loss: 3902842.6473
Epoch 80/200
41664/41664 [==============================] - 17s 418us/step - loss: 3884579.2320
Epoch 81/200
41664/41664 [==============================] - 17s 418us/step - loss: 3866266.5977
Epoch 82/200
41664/41664 [==============================] - 17s 418us/step - loss: 3846885.8389
Epoch 83/200
41664/41664 [==============================] - 17s 418us/step - loss: 3830729.2004
Epoch 84/200
41664/41664 [==============================] - 17s 419us/step - loss: 3813853.2999
Epoch 85/200
41664/41664 [==============================] - 17s 419us/step - loss: 3798710.3452
Epoch 86/200
41664/41664 [==============================] - 17s 418us/step - loss: 3783936.9806
Epoch 87/200
41664/41664 [==============================] - 17s 418us/step - loss: 3768997.4464
Epoch 88/200
41664/41664 [==============================] - 18s 420us/step - loss: 3761039.5845
Epoch 89/200
41664/41664 [==============================] - 17s 418us/step - loss: 3743481.8474
Epoch 90/200
41664/41664 [==============================] - 17s 420us/step - loss: 3732615.9138
Epoch 91/200
41664/41664 [==============================] - 17s 420us/step - loss: 3721413.0770
Epoch 92/200
41664/41664 [==============================] - 17s 418us/step - loss: 3708227.1559
Epoch 93/200
41664/41664 [==============================] - 17s 418us/step - loss: 3698026.5693
Epoch 94/200
41664/41664 [==============================] - 17s 417us/step - loss: 3685352.7034
Epoch 95/200
41664/41664 [==============================] - 17s 417us/step - loss: 3673725.1621
Epoch 96/200
41664/41664 [==============================] - 17s 417us/step - loss: 3660057.0675
Epoch 97/200
41664/41664 [==============================] - 17s 418us/step - loss: 3651573.6815
Epoch 98/200
41664/41664 [==============================] - 17s 418us/step - loss: 3643860.0585
Epoch 99/200
41664/41664 [==============================] - 17s 419us/step - loss: 3642759.0650
Epoch 100/200
41664/41664 [==============================] - 17s 418us/step - loss: 3636854.2052
Epoch 101/200
41664/41664 [==============================] - 17s 418us/step - loss: 3629596.5622
Epoch 102/200
41664/41664 [==============================] - 17s 419us/step - loss: 3621721.9166
Epoch 103/200
41664/41664 [==============================] - 17s 419us/step - loss: 3604287.5048
Epoch 104/200
41664/41664 [==============================] - 17s 418us/step - loss: 3598777.5338
Epoch 105/200
41664/41664 [==============================] - 17s 419us/step - loss: 3589817.2895
Epoch 106/200
41664/41664 [==============================] - 17s 417us/step - loss: 3591083.7958
Epoch 107/200
41664/41664 [==============================] - 17s 417us/step - loss: 3585225.2335
Epoch 108/200
41664/41664 [==============================] - 17s 419us/step - loss: 3583578.0970
Epoch 109/200
41664/41664 [==============================] - 17s 419us/step - loss: 3600006.1067
Epoch 110/200
41664/41664 [==============================] - 17s 418us/step - loss: 3607323.9010
Epoch 111/200
41664/41664 [==============================] - 17s 420us/step - loss: 3597268.8577
Epoch 112/200
41664/41664 [==============================] - 17s 418us/step - loss: 3594191.0863
Epoch 113/200
41664/41664 [==============================] - 17s 419us/step - loss: 3594181.2720
Epoch 114/200
41664/41664 [==============================] - 17s 420us/step - loss: 3588023.4531
Epoch 115/200
41664/41664 [==============================] - 17s 417us/step - loss: 3587445.6017
Epoch 116/200
41664/41664 [==============================] - 17s 417us/step - loss: 3593883.1489
Epoch 117/200
41664/41664 [==============================] - 17s 417us/step - loss: 3594851.9657
Epoch 118/200
41664/41664 [==============================] - 17s 418us/step - loss: 3595897.2687
Epoch 119/200
41664/41664 [==============================] - 17s 416us/step - loss: 3600842.3820
Epoch 120/200
41664/41664 [==============================] - 17s 418us/step - loss: 3603355.8563
Epoch 121/200
41664/41664 [==============================] - 17s 419us/step - loss: 3600615.3337
Epoch 122/200
41664/41664 [==============================] - 17s 417us/step - loss: 3599380.3472
Epoch 123/200
41664/41664 [==============================] - 17s 420us/step - loss: 3593910.4108
Epoch 124/200
41664/41664 [==============================] - 17s 418us/step - loss: 3591608.6229
Epoch 125/200
41664/41664 [==============================] - 17s 417us/step - loss: 3592219.0865
Epoch 126/200
41664/41664 [==============================] - 17s 416us/step - loss: 3592150.9680
Epoch 127/200
41664/41664 [==============================] - 17s 419us/step - loss: 3590575.5958
Epoch 128/200
41664/41664 [==============================] - 17s 416us/step - loss: 3602048.4421
Epoch 129/200
41664/41664 [==============================] - 17s 420us/step - loss: 3615710.2639
Epoch 130/200
41664/41664 [==============================] - 17s 418us/step - loss: 3615463.7458
Epoch 131/200
41664/41664 [==============================] - 17s 418us/step - loss: 3617340.2413
Epoch 132/200
41664/41664 [==============================] - 17s 418us/step - loss: 3618886.1161
Epoch 133/200
41664/41664 [==============================] - 17s 417us/step - loss: 3634671.7655
Epoch 134/200
41664/41664 [==============================] - 17s 417us/step - loss: 3639863.9818
Epoch 135/200
41664/41664 [==============================] - 17s 419us/step - loss: 3648803.7614
Epoch 136/200
41664/41664 [==============================] - 17s 420us/step - loss: 3656719.4841
Epoch 137/200
41664/41664 [==============================] - 17s 417us/step - loss: 3666550.0171
Epoch 138/200
41664/41664 [==============================] - 17s 418us/step - loss: 3669169.2532
Epoch 139/200
41664/41664 [==============================] - 18s 420us/step - loss: 3672412.7160
Epoch 140/200
41664/41664 [==============================] - 17s 418us/step - loss: 3676985.3695
Epoch 141/200
41664/41664 [==============================] - 17s 418us/step - loss: 3679630.9682
Epoch 142/200
41664/41664 [==============================] - 17s 419us/step - loss: 3682154.9882
Epoch 143/200
41664/41664 [==============================] - 17s 417us/step - loss: 3685366.8663
Epoch 144/200
41664/41664 [==============================] - 17s 420us/step - loss: 3690490.7780
Epoch 145/200
41664/41664 [==============================] - 17s 418us/step - loss: 3688620.6379
Epoch 146/200
41664/41664 [==============================] - 18s 427us/step - loss: 3695465.4696
Epoch 147/200
41664/41664 [==============================] - 18s 420us/step - loss: 3693831.9844
Epoch 148/200
41664/41664 [==============================] - 17s 418us/step - loss: 3694327.0976
Epoch 149/200
41664/41664 [==============================] - 18s 420us/step - loss: 3689707.1342
Epoch 150/200
41664/41664 [==============================] - 17s 418us/step - loss: 3683327.8607
Epoch 151/200
41664/41664 [==============================] - 17s 419us/step - loss: 3683229.1960
Epoch 152/200
41664/41664 [==============================] - 17s 420us/step - loss: 3683455.0801
Epoch 153/200
41664/41664 [==============================] - 18s 422us/step - loss: 3683376.2601
Epoch 154/200
41664/41664 [==============================] - 17s 420us/step - loss: 3674370.1449
Epoch 155/200
41664/41664 [==============================] - 17s 419us/step - loss: 3672615.6554
Epoch 156/200
41664/41664 [==============================] - 17s 418us/step - loss: 3665001.3490
Epoch 157/200
41664/41664 [==============================] - 17s 419us/step - loss: 3654508.2824
Epoch 158/200
41664/41664 [==============================] - 17s 420us/step - loss: 3646554.1652
Epoch 159/200
41664/41664 [==============================] - 17s 419us/step - loss: 3638812.5080
Epoch 160/200
41664/41664 [==============================] - 18s 429us/step - loss: 3631143.1260
Epoch 161/200
41664/41664 [==============================] - 18s 437us/step - loss: 3621035.4262
Epoch 162/200
41664/41664 [==============================] - 18s 424us/step - loss: 3612753.9400
Epoch 163/200
41664/41664 [==============================] - 17s 417us/step - loss: 3601992.0149
Epoch 164/200
41664/41664 [==============================] - 17s 417us/step - loss: 3594541.5118
Epoch 165/200
41664/41664 [==============================] - 17s 419us/step - loss: 3586464.2251
Epoch 166/200
41664/41664 [==============================] - 17s 418us/step - loss: 3577589.5222
Epoch 167/200
41664/41664 [==============================] - 17s 418us/step - loss: 3565771.2969
Epoch 168/200
41664/41664 [==============================] - 17s 419us/step - loss: 3547432.7756
Epoch 169/200
41664/41664 [==============================] - 17s 419us/step - loss: 3530340.3934
Epoch 170/200
41664/41664 [==============================] - 17s 418us/step - loss: 3509380.5531
Epoch 171/200
41664/41664 [==============================] - 18s 422us/step - loss: 3495695.1258
Epoch 172/200
41664/41664 [==============================] - 18s 421us/step - loss: 3484284.5621
Epoch 173/200
41664/41664 [==============================] - 17s 417us/step - loss: 3472192.1203
Epoch 174/200
41664/41664 [==============================] - 17s 419us/step - loss: 3472441.0195
Epoch 175/200
41664/41664 [==============================] - 17s 416us/step - loss: 3468155.9385
Epoch 176/200
41664/41664 [==============================] - 17s 417us/step - loss: 3460983.4304
Epoch 177/200
41664/41664 [==============================] - 17s 417us/step - loss: 3458672.3323
Epoch 178/200
41664/41664 [==============================] - 17s 418us/step - loss: 3454695.4863
Epoch 179/200
41664/41664 [==============================] - 17s 418us/step - loss: 3445791.6238
Epoch 180/200
41664/41664 [==============================] - 17s 417us/step - loss: 3433211.7521
Epoch 181/200
41664/41664 [==============================] - 17s 418us/step - loss: 3421539.0754
Epoch 182/200
41664/41664 [==============================] - 17s 418us/step - loss: 3411298.7087
Epoch 183/200
41664/41664 [==============================] - 17s 418us/step - loss: 3402124.1349
Epoch 184/200
41664/41664 [==============================] - 18s 421us/step - loss: 3397540.4321
Epoch 185/200
41664/41664 [==============================] - 17s 418us/step - loss: 3390592.1630
Epoch 186/200
41664/41664 [==============================] - 17s 419us/step - loss: 3384897.2624
Epoch 187/200
41664/41664 [==============================] - 17s 418us/step - loss: 3373175.9096
Epoch 188/200
41664/41664 [==============================] - 17s 418us/step - loss: 3357310.7695
Epoch 189/200
41664/41664 [==============================] - 17s 419us/step - loss: 3348539.8134
Epoch 190/200
41664/41664 [==============================] - 17s 417us/step - loss: 3338720.0533
Epoch 191/200
41664/41664 [==============================] - 17s 420us/step - loss: 3330715.0728
Epoch 192/200
41664/41664 [==============================] - 18s 421us/step - loss: 3320646.9722
Epoch 193/200
41664/41664 [==============================] - 17s 419us/step - loss: 3312023.1291
Epoch 194/200
41664/41664 [==============================] - 17s 417us/step - loss: 3307035.5107
Epoch 195/200
41664/41664 [==============================] - 17s 418us/step - loss: 3295200.0846
Epoch 196/200
41664/41664 [==============================] - 17s 418us/step - loss: 3289675.2813
Epoch 197/200
41664/41664 [==============================] - 17s 417us/step - loss: 3284835.1392
Epoch 198/200
41664/41664 [==============================] - 17s 419us/step - loss: 3284112.3430
Epoch 199/200
41664/41664 [==============================] - 17s 418us/step - loss: 3279928.4922
Epoch 200/200
41664/41664 [==============================] - 17s 418us/step - loss: 3276487.5823
The R2 score on the Train set is:       0.390
The R2 score on the Test set is:        -0.215

---     3507.608 seconds --- LSTM

LSTM has been executed.

---     3508.166 seconds --- general processing
